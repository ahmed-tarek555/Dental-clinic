<!DOCTYPE html>
<html>
<head>
  <title>Reset Password</title>
</head>
<body>
  <h2>Reset Password</h2>

  <form id="reset_form" onsubmit="reset_code(event)">
    <label>Email:</label>
    <input type="email" name="email" required>

    <label>Reset Code:</label>
    <input type="text" name="code" required>

    <label>New Password:</label>
    <input type="password" name="new_password" required>

    <button type="submit">Reset Password</button>
    <p id="response"></p>
    <a id="login_page" href="/login-page"></a>
  </form>

  <script>
async function reset_code(e) {
    e.preventDefault();

    const form = new FormData(document.getElementById("reset_form"));

    const res = await fetch("/reset-password", {
        method: "POST",
        body: form
    });

    const data = await res.json();

    if (!res.ok) {
        document.getElementById("response").innerText = data.detail;
        return;
    }

    document.getElementById("response").innerText = data.message;

    const loginLink = document.getElementById("login_page");
    loginLink.innerText = "Go to login";
}
  </script>

</body>
</html>
